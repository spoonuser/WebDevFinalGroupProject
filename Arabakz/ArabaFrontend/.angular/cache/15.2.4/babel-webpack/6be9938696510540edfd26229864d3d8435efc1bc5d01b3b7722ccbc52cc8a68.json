{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.validateSchemaDeps = exports.validatePropertyDeps = exports.error = void 0;\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst code_1 = require(\"../code\");\nexports.error = {\n  message: ({\n    params: {\n      property,\n      depsCount,\n      deps\n    }\n  }) => {\n    const property_ies = depsCount === 1 ? \"property\" : \"properties\";\n    return (0, codegen_1.str)`must have ${property_ies} ${deps} when property ${property} is present`;\n  },\n  params: ({\n    params: {\n      property,\n      depsCount,\n      deps,\n      missingProperty\n    }\n  }) => (0, codegen_1._)`{property: ${property},\n    missingProperty: ${missingProperty},\n    depsCount: ${depsCount},\n    deps: ${deps}}` // TODO change to reference\n};\n\nconst def = {\n  keyword: \"dependencies\",\n  type: \"object\",\n  schemaType: \"object\",\n  error: exports.error,\n  code(cxt) {\n    const [propDeps, schDeps] = splitDependencies(cxt);\n    validatePropertyDeps(cxt, propDeps);\n    validateSchemaDeps(cxt, schDeps);\n  }\n};\nfunction splitDependencies({\n  schema\n}) {\n  const propertyDeps = {};\n  const schemaDeps = {};\n  for (const key in schema) {\n    if (key === \"__proto__\") continue;\n    const deps = Array.isArray(schema[key]) ? propertyDeps : schemaDeps;\n    deps[key] = schema[key];\n  }\n  return [propertyDeps, schemaDeps];\n}\nfunction validatePropertyDeps(cxt, propertyDeps = cxt.schema) {\n  const {\n    gen,\n    data,\n    it\n  } = cxt;\n  if (Object.keys(propertyDeps).length === 0) return;\n  const missing = gen.let(\"missing\");\n  for (const prop in propertyDeps) {\n    const deps = propertyDeps[prop];\n    if (deps.length === 0) continue;\n    const hasProperty = (0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties);\n    cxt.setParams({\n      property: prop,\n      depsCount: deps.length,\n      deps: deps.join(\", \")\n    });\n    if (it.allErrors) {\n      gen.if(hasProperty, () => {\n        for (const depProp of deps) {\n          (0, code_1.checkReportMissingProp)(cxt, depProp);\n        }\n      });\n    } else {\n      gen.if((0, codegen_1._)`${hasProperty} && (${(0, code_1.checkMissingProp)(cxt, deps, missing)})`);\n      (0, code_1.reportMissingProp)(cxt, missing);\n      gen.else();\n    }\n  }\n}\nexports.validatePropertyDeps = validatePropertyDeps;\nfunction validateSchemaDeps(cxt, schemaDeps = cxt.schema) {\n  const {\n    gen,\n    data,\n    keyword,\n    it\n  } = cxt;\n  const valid = gen.name(\"valid\");\n  for (const prop in schemaDeps) {\n    if ((0, util_1.alwaysValidSchema)(it, schemaDeps[prop])) continue;\n    gen.if((0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties), () => {\n      const schCxt = cxt.subschema({\n        keyword,\n        schemaProp: prop\n      }, valid);\n      cxt.mergeValidEvaluated(schCxt, valid);\n    }, () => gen.var(valid, true) // TODO var\n    );\n\n    cxt.ok(valid);\n  }\n}\nexports.validateSchemaDeps = validateSchemaDeps;\nexports.default = def;","map":{"version":3,"names":["Object","defineProperty","exports","value","validateSchemaDeps","validatePropertyDeps","error","codegen_1","require","util_1","code_1","message","params","property","depsCount","deps","property_ies","str","missingProperty","_","def","keyword","type","schemaType","code","cxt","propDeps","schDeps","splitDependencies","schema","propertyDeps","schemaDeps","key","Array","isArray","gen","data","it","keys","length","missing","let","prop","hasProperty","propertyInData","opts","ownProperties","setParams","join","allErrors","if","depProp","checkReportMissingProp","checkMissingProp","reportMissingProp","else","valid","name","alwaysValidSchema","schCxt","subschema","schemaProp","mergeValidEvaluated","var","ok","default"],"sources":["/Users/sabyrzhanolzhabay/Web-Dev/Arabakz/ArabaFrontend/node_modules/ajv/dist/vocabularies/applicator/dependencies.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.validateSchemaDeps = exports.validatePropertyDeps = exports.error = void 0;\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst code_1 = require(\"../code\");\nexports.error = {\n    message: ({ params: { property, depsCount, deps } }) => {\n        const property_ies = depsCount === 1 ? \"property\" : \"properties\";\n        return (0, codegen_1.str) `must have ${property_ies} ${deps} when property ${property} is present`;\n    },\n    params: ({ params: { property, depsCount, deps, missingProperty } }) => (0, codegen_1._) `{property: ${property},\n    missingProperty: ${missingProperty},\n    depsCount: ${depsCount},\n    deps: ${deps}}`, // TODO change to reference\n};\nconst def = {\n    keyword: \"dependencies\",\n    type: \"object\",\n    schemaType: \"object\",\n    error: exports.error,\n    code(cxt) {\n        const [propDeps, schDeps] = splitDependencies(cxt);\n        validatePropertyDeps(cxt, propDeps);\n        validateSchemaDeps(cxt, schDeps);\n    },\n};\nfunction splitDependencies({ schema }) {\n    const propertyDeps = {};\n    const schemaDeps = {};\n    for (const key in schema) {\n        if (key === \"__proto__\")\n            continue;\n        const deps = Array.isArray(schema[key]) ? propertyDeps : schemaDeps;\n        deps[key] = schema[key];\n    }\n    return [propertyDeps, schemaDeps];\n}\nfunction validatePropertyDeps(cxt, propertyDeps = cxt.schema) {\n    const { gen, data, it } = cxt;\n    if (Object.keys(propertyDeps).length === 0)\n        return;\n    const missing = gen.let(\"missing\");\n    for (const prop in propertyDeps) {\n        const deps = propertyDeps[prop];\n        if (deps.length === 0)\n            continue;\n        const hasProperty = (0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties);\n        cxt.setParams({\n            property: prop,\n            depsCount: deps.length,\n            deps: deps.join(\", \"),\n        });\n        if (it.allErrors) {\n            gen.if(hasProperty, () => {\n                for (const depProp of deps) {\n                    (0, code_1.checkReportMissingProp)(cxt, depProp);\n                }\n            });\n        }\n        else {\n            gen.if((0, codegen_1._) `${hasProperty} && (${(0, code_1.checkMissingProp)(cxt, deps, missing)})`);\n            (0, code_1.reportMissingProp)(cxt, missing);\n            gen.else();\n        }\n    }\n}\nexports.validatePropertyDeps = validatePropertyDeps;\nfunction validateSchemaDeps(cxt, schemaDeps = cxt.schema) {\n    const { gen, data, keyword, it } = cxt;\n    const valid = gen.name(\"valid\");\n    for (const prop in schemaDeps) {\n        if ((0, util_1.alwaysValidSchema)(it, schemaDeps[prop]))\n            continue;\n        gen.if((0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties), () => {\n            const schCxt = cxt.subschema({ keyword, schemaProp: prop }, valid);\n            cxt.mergeValidEvaluated(schCxt, valid);\n        }, () => gen.var(valid, true) // TODO var\n        );\n        cxt.ok(valid);\n    }\n}\nexports.validateSchemaDeps = validateSchemaDeps;\nexports.default = def;\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,kBAAkB,GAAGF,OAAO,CAACG,oBAAoB,GAAGH,OAAO,CAACI,KAAK,GAAG,KAAK,CAAC;AAClF,MAAMC,SAAS,GAAGC,OAAO,CAAC,uBAAuB,CAAC;AAClD,MAAMC,MAAM,GAAGD,OAAO,CAAC,oBAAoB,CAAC;AAC5C,MAAME,MAAM,GAAGF,OAAO,CAAC,SAAS,CAAC;AACjCN,OAAO,CAACI,KAAK,GAAG;EACZK,OAAO,EAAE,CAAC;IAAEC,MAAM,EAAE;MAAEC,QAAQ;MAAEC,SAAS;MAAEC;IAAK;EAAE,CAAC,KAAK;IACpD,MAAMC,YAAY,GAAGF,SAAS,KAAK,CAAC,GAAG,UAAU,GAAG,YAAY;IAChE,OAAO,CAAC,CAAC,EAAEP,SAAS,CAACU,GAAG,CAAG,aAAYD,YAAa,IAAGD,IAAK,kBAAiBF,QAAS,aAAY;EACtG,CAAC;EACDD,MAAM,EAAE,CAAC;IAAEA,MAAM,EAAE;MAAEC,QAAQ;MAAEC,SAAS;MAAEC,IAAI;MAAEG;IAAgB;EAAE,CAAC,KAAK,CAAC,CAAC,EAAEX,SAAS,CAACY,CAAC,CAAG,cAAaN,QAAS;AACpH,uBAAuBK,eAAgB;AACvC,iBAAiBJ,SAAU;AAC3B,YAAYC,IAAK,GAAE,CAAE;AACrB,CAAC;;AACD,MAAMK,GAAG,GAAG;EACRC,OAAO,EAAE,cAAc;EACvBC,IAAI,EAAE,QAAQ;EACdC,UAAU,EAAE,QAAQ;EACpBjB,KAAK,EAAEJ,OAAO,CAACI,KAAK;EACpBkB,IAAI,CAACC,GAAG,EAAE;IACN,MAAM,CAACC,QAAQ,EAAEC,OAAO,CAAC,GAAGC,iBAAiB,CAACH,GAAG,CAAC;IAClDpB,oBAAoB,CAACoB,GAAG,EAAEC,QAAQ,CAAC;IACnCtB,kBAAkB,CAACqB,GAAG,EAAEE,OAAO,CAAC;EACpC;AACJ,CAAC;AACD,SAASC,iBAAiB,CAAC;EAAEC;AAAO,CAAC,EAAE;EACnC,MAAMC,YAAY,GAAG,CAAC,CAAC;EACvB,MAAMC,UAAU,GAAG,CAAC,CAAC;EACrB,KAAK,MAAMC,GAAG,IAAIH,MAAM,EAAE;IACtB,IAAIG,GAAG,KAAK,WAAW,EACnB;IACJ,MAAMjB,IAAI,GAAGkB,KAAK,CAACC,OAAO,CAACL,MAAM,CAACG,GAAG,CAAC,CAAC,GAAGF,YAAY,GAAGC,UAAU;IACnEhB,IAAI,CAACiB,GAAG,CAAC,GAAGH,MAAM,CAACG,GAAG,CAAC;EAC3B;EACA,OAAO,CAACF,YAAY,EAAEC,UAAU,CAAC;AACrC;AACA,SAAS1B,oBAAoB,CAACoB,GAAG,EAAEK,YAAY,GAAGL,GAAG,CAACI,MAAM,EAAE;EAC1D,MAAM;IAAEM,GAAG;IAAEC,IAAI;IAAEC;EAAG,CAAC,GAAGZ,GAAG;EAC7B,IAAIzB,MAAM,CAACsC,IAAI,CAACR,YAAY,CAAC,CAACS,MAAM,KAAK,CAAC,EACtC;EACJ,MAAMC,OAAO,GAAGL,GAAG,CAACM,GAAG,CAAC,SAAS,CAAC;EAClC,KAAK,MAAMC,IAAI,IAAIZ,YAAY,EAAE;IAC7B,MAAMf,IAAI,GAAGe,YAAY,CAACY,IAAI,CAAC;IAC/B,IAAI3B,IAAI,CAACwB,MAAM,KAAK,CAAC,EACjB;IACJ,MAAMI,WAAW,GAAG,CAAC,CAAC,EAAEjC,MAAM,CAACkC,cAAc,EAAET,GAAG,EAAEC,IAAI,EAAEM,IAAI,EAAEL,EAAE,CAACQ,IAAI,CAACC,aAAa,CAAC;IACtFrB,GAAG,CAACsB,SAAS,CAAC;MACVlC,QAAQ,EAAE6B,IAAI;MACd5B,SAAS,EAAEC,IAAI,CAACwB,MAAM;MACtBxB,IAAI,EAAEA,IAAI,CAACiC,IAAI,CAAC,IAAI;IACxB,CAAC,CAAC;IACF,IAAIX,EAAE,CAACY,SAAS,EAAE;MACdd,GAAG,CAACe,EAAE,CAACP,WAAW,EAAE,MAAM;QACtB,KAAK,MAAMQ,OAAO,IAAIpC,IAAI,EAAE;UACxB,CAAC,CAAC,EAAEL,MAAM,CAAC0C,sBAAsB,EAAE3B,GAAG,EAAE0B,OAAO,CAAC;QACpD;MACJ,CAAC,CAAC;IACN,CAAC,MACI;MACDhB,GAAG,CAACe,EAAE,CAAC,CAAC,CAAC,EAAE3C,SAAS,CAACY,CAAC,CAAG,GAAEwB,WAAY,QAAO,CAAC,CAAC,EAAEjC,MAAM,CAAC2C,gBAAgB,EAAE5B,GAAG,EAAEV,IAAI,EAAEyB,OAAO,CAAE,GAAE,CAAC;MAClG,CAAC,CAAC,EAAE9B,MAAM,CAAC4C,iBAAiB,EAAE7B,GAAG,EAAEe,OAAO,CAAC;MAC3CL,GAAG,CAACoB,IAAI,EAAE;IACd;EACJ;AACJ;AACArD,OAAO,CAACG,oBAAoB,GAAGA,oBAAoB;AACnD,SAASD,kBAAkB,CAACqB,GAAG,EAAEM,UAAU,GAAGN,GAAG,CAACI,MAAM,EAAE;EACtD,MAAM;IAAEM,GAAG;IAAEC,IAAI;IAAEf,OAAO;IAAEgB;EAAG,CAAC,GAAGZ,GAAG;EACtC,MAAM+B,KAAK,GAAGrB,GAAG,CAACsB,IAAI,CAAC,OAAO,CAAC;EAC/B,KAAK,MAAMf,IAAI,IAAIX,UAAU,EAAE;IAC3B,IAAI,CAAC,CAAC,EAAEtB,MAAM,CAACiD,iBAAiB,EAAErB,EAAE,EAAEN,UAAU,CAACW,IAAI,CAAC,CAAC,EACnD;IACJP,GAAG,CAACe,EAAE,CAAC,CAAC,CAAC,EAAExC,MAAM,CAACkC,cAAc,EAAET,GAAG,EAAEC,IAAI,EAAEM,IAAI,EAAEL,EAAE,CAACQ,IAAI,CAACC,aAAa,CAAC,EAAE,MAAM;MAC7E,MAAMa,MAAM,GAAGlC,GAAG,CAACmC,SAAS,CAAC;QAAEvC,OAAO;QAAEwC,UAAU,EAAEnB;MAAK,CAAC,EAAEc,KAAK,CAAC;MAClE/B,GAAG,CAACqC,mBAAmB,CAACH,MAAM,EAAEH,KAAK,CAAC;IAC1C,CAAC,EAAE,MAAMrB,GAAG,CAAC4B,GAAG,CAACP,KAAK,EAAE,IAAI,CAAC,CAAC;IAAA,CAC7B;;IACD/B,GAAG,CAACuC,EAAE,CAACR,KAAK,CAAC;EACjB;AACJ;AACAtD,OAAO,CAACE,kBAAkB,GAAGA,kBAAkB;AAC/CF,OAAO,CAAC+D,OAAO,GAAG7C,GAAG"},"metadata":{},"sourceType":"script","externalDependencies":[]}